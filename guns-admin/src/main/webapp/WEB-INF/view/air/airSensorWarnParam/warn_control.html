@layout('/common/_container.html'){
@var station = airStation.findCurrentStation();
<link href="${ctxPath}/static/switch/css/switch.css" rel="stylesheet">	
<link href="${ctxPath}/static/bootstrap-switch/bootstrap-switch.min.css" rel="stylesheet">	
<script type="text/javascript" src="${ctxPath}/static/bootstrap-switch/bootstrap-switch.min.js"></script>
<script type="text/javascript">
	$(function(){
		$("input[name='my-checkbox']").bootstrapSwitch({
			 onText:'开',  
	         offText:'关',
	         onColor:"success",    
            offColor:"info",    
            size:"small", 
	        onSwitchChange:function(event,state){    
	            if(state==true){    
	               //alert('已打开');    
	            }else{    
	                //alert('已关闭');    
	            }
	        }
		});
		
		
		//打开
        $("input[name='my-checkbox']").bootstrapSwitch('toggleState');
	});
</script>
<div class="row">
    <div class="col-sm-12">
        <div class="ibox float-e-margins">
		
            <div class="ibox-title">
                <h5>预警控制</h5>
            </div>
            
            
            <input type="hidden" value="${station.code!}" id="station_code"/>
			
            <div class="ibox-content">
                <div class="row row-lg">
				
                    <div class="col-sm-12">
                       	<div class="row">
						    
							<!-- <div class="col-lg-2 col-sm-3" >
							    <input class="form-control" style="margin-bottom: 10px;" id="search_input" name="code" placeholder="输入名称查询" type="text">
								<div class="panel panel-default">
									<div class="panel-heading">区域列表</div>
									<div class="panel-body dept-tree scrollbar" style="overflow-x:scroll">
										<ul id="areaTree" class="ztree"></ul>
									</div>
								</div>
							</div>  -->
							
							<div class="col-sm-9" style="left: 275px;">
								 <div class="col-sm-12" style="padding-left:5px">
									<div class="row">
									
										<div class="col-lg-12 col-sm-12" style="padding:0">
											<div class="panel panel-default">
												<div class="panel-heading" style="text-align:center">
													
						                            <button type="button" id="loading-example-btn" style="float: left;" class="btn btn-white btn-sm" onclick="checkOnline();"><i class="fa fa-check-circle"></i> 检查在线</button>
													<div class="acenter" style="line-height: 35px;"><i class="fa fa-search">设备操作日志</i></span></div>
													<div class="clearfix"></div>
												</div>
												
												<div class="panel-body">
												  
													<div class="row" id="real_time_status">
														<div class="col-md-2 col-sm-4 col-xs-4">
														   <div class="widget gray-bg orders">
															<div class="row">
																	<div class="col-sm-4">
																		<!--<i class="fa fa-cloud fa-5x"></i>-->
																		<div class="text-center">
																			<img alt="image" class="img-circle m-t-xs img-responsive" src="${ctxPath}/static/img/sensor/fengsu.png">
																		</div>
																	</div>
																	<div class="col-sm-8">
																		<h3 class="switch-title"><font>风速</font></h3>
																		
																			<div class="switch" >
																			    <input type="checkbox"   name="my-checkbox"/>
																			</div>
																			
																		
																	</div>
																	<div class="clearfix"></div>
															</div>
														   </div>
														</div>
														
														<div class="col-md-2 col-sm-4 col-xs-4">
														   <div class="widget gray-bg orders">
															<div class="row">
																	<div class="col-sm-4">
																		<!--<i class="fa fa-cloud fa-5x"></i>-->
																		<div class="text-center">
																			<img alt="image" class="img-circle m-t-xs img-responsive" src="${ctxPath}/static/img/sensor/fengsu.png">
																		</div>
																	</div>
																	<div class="col-sm-8">
																		<h3 class="switch-title"><font>风速</font></h3>
																		<div class="switch" >
																			    <input type="checkbox"   name="my-checkbox"/>
																			</div>
																	</div>
																	<div class="clearfix"></div>
															</div>
														   </div>
														</div>
														
														<div class="col-md-2 col-sm-4 col-xs-4">
														   <div class="widget gray-bg orders">
															<div class="row">
																	<div class="col-sm-4">
																		<!--<i class="fa fa-cloud fa-5x"></i>-->
																		<div class="text-center">
																			<img alt="image" class="img-circle m-t-xs img-responsive" src="${ctxPath}/static/img/sensor/fengsu.png">
																		</div>
																	</div>
																	<div class="col-sm-8">
																		<h3 class="switch-title"><font>风速</font></h3>
																		<div class="switch" >
																			    <input type="checkbox"   name="my-checkbox"/>
																			</div>
																	</div>
																	<div class="clearfix"></div>
															</div>
														   </div>
														</div>
												
														<div class="col-md-2 col-sm-4 col-xs-4">
														   <div class="widget gray-bg orders">
															<div class="row">
																	<div class="col-sm-4">
																		<!--<i class="fa fa-cloud fa-5x"></i>-->
																		<div class="text-center">
																			<img alt="image" class="img-circle m-t-xs img-responsive" src="${ctxPath}/static/img/sensor/fengsu.png">
																		</div>
																	</div>
																	<div class="col-sm-8">
																		<h3 class="switch-title"><font>风速</font></h3>
																		<div class="switch" >
																			    <input type="checkbox"   name="my-checkbox"/>
																			</div>
																	</div>
																	<div class="clearfix"></div>
															</div>
														   </div>
														</div>
														
														<div class="col-md-2 col-sm-4 col-xs-4">
														   <div class="widget gray-bg orders">
															<div class="row">
																	<div class="col-sm-4">
																		<!--<i class="fa fa-cloud fa-5x"></i>-->
																		<div class="text-center">
																			<img alt="image" class="img-circle m-t-xs img-responsive" src="${ctxPath}/static/img/sensor/fengsu.png">
																		</div>
																	</div>
																	<div class="col-sm-8">
																		<h3 class="switch-title"><font>风速</font></h3>
																			<div class="switch" >
																			    <input type="checkbox"   name="my-checkbox"/>
																			</div>																	</div>
																	<div class="clearfix"></div>
															</div>
														   </div>
														</div>
														
														<div class="col-md-2 col-sm-4 col-xs-4">
														   <div class="widget gray-bg orders">
															<div class="row">
																	<div class="col-sm-4">
																		<!--<i class="fa fa-cloud fa-5x"></i>-->
																		<div class="text-center">
																			<img alt="image" class="img-circle m-t-xs img-responsive" src="${ctxPath}/static/img/sensor/fengsu.png">
																		</div>
																	</div>
																	<div class="col-sm-8">
																		<h3 class="switch-title"><font>风速</font></h3>
																		<div class="switch" >
																			    <input type="checkbox"   name="my-checkbox"/>
																			</div>
																	</div>
																	<div class="clearfix"></div>
															</div>
														   </div>
														</div>
														
													</div>
												  
												</div>
											</div>
										</div> 
										
										<div class="col-lg-12 col-sm-12" style="padding:0">
											<div class="panel panel-default" style="margin-bottom:0px;">
												<div class="panel-heading">预警参数</div>
												<div class="panel-body" style="position: relative; margin: 0; padding: 0px;overflow: hidden;">
												
	
													<table class="table table-bordered table-hover atable">
														<thead>
															<tr style="font-weight: bold;">
																<th class="center">传感器</th>
																<th class="center">工作时间</th>
																<th class="center">表达式</th>
																<th class="center">阈值</th>
																<th class="center">控制方式</th>
																<th class="center">预警间隔（分钟）</th>
																<th class="center">操作</th>
																<th class="center">异常报警（分钟）</th>
																<th class="center">顺序位</th>
															</tr>
														</thead>
														<tbody style="height:480px;" id="sensor_status">
															
															
														</tbody>
													</table>
												</div>
											</div>
										</div> 
										
									</div>
								</div>
							</div> 
                        </div>
                    </div>
					
                </div>
            </div>
        </div>
    </div>
</div>
<script src="${ctxPath}/static/modular/air/airSensorWarnParam/warnControl.js"></script>
<script>
function checkOnline(){
	var sensorId;
	var sensor=$('#real_time_status').find('.warn-control-selected');
	if(sensor){
		var tagName=sensor.find('.switch-title').next().prop('tagName');
		if(tagName=='DIV'){
			sensorId=sensor.find("input[name='my-checkbox']")[0].id;
		}else{
			sensorId=sensor.find('button').attr('id');
		}
	}
	if(sensorId){
		var url=Feng.ctxPath+'/airSensor/checkOnline';
        layer.msg('指令发送成功,请稍后.', {
        	  icon: 16,
        	  time: 1000000, //2秒关闭（如果不配置，默认是3秒）
        	  shade: [0.1,'#fff'] //0.1透明度的白色背景
        });
        $.post(url,{ids : sensorId+';'},function(result){
        	
        	if(result.code=='000000'){
    			 var index=layer.msg('选中的设备都在线!',{icon:1},function(){
        				location.reload();
        			});
    		 }else{
    			var index=layer.msg(result.msg,{icon:5},function(){
    				location.reload();
    			});
    		 }
        });
	}else{
		layer.msg('请选择要检查的传感器!',{icon:5});
	}
	
}
</script>
@}